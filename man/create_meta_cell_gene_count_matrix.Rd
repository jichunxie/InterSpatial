% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/create_meta_cells.R
\name{create_meta_cell_gene_count_matrix}
\alias{create_meta_cell_gene_count_matrix}
\title{Create Meta-Cell Gene Expression Matrix}
\usage{
create_meta_cell_gene_count_matrix(dat_scRNA, cluster_labels)
}
\arguments{
\item{dat_scRNA}{A Seurat object containing raw RNA assay counts.}

\item{cluster_labels}{A data frame with columns \code{"cell"} and \code{"cluster"}, mapping each cell to a cluster.}
}
\value{
A sparse matrix of dimensions (clusters x genes) with log-normalized expression.
An attribute \code{"gene_symbol_type"} is attached indicating whether gene names are ENSEMBL or SYMBOL.
}
\description{
Aggregates log-normalized gene expression from individual cells into meta-cell (cluster-level) profiles.
}
\details{
This function performs log-normalization using CPM scaling (counts per 10k),
aggregates expression per cluster using matrix operations, and returns a cluster-by-gene sparse matrix.
The function also auto-detects whether the gene identifiers are in ENSEMBL format.
}
