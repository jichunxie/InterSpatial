% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/compute_wasserstein_distance.R
\name{compute_wasserstein_distance_between_cell_type}
\alias{compute_wasserstein_distance_between_cell_type}
\title{Compute Wasserstein Distances Between Meta-Cells of Two Cell Types}
\usage{
compute_wasserstein_distance_between_cell_type(
  prob_data,
  dat_visium,
  visium.data.dir,
  source_cell_type,
  receiver_cell_type,
  meta_cell_labels = NULL,
  cluster_labels = NULL,
  thres_source_proportion = 0.5,
  thres_receiver_proportion = 0.5,
  out_file_prefix = "wass_distance_meta_cells_to_meta_cells",
  chunk_size = 10000,
  out_dir = ".",
  nCores = NULL,
  parallelize = TRUE
)
}
\arguments{
\item{prob_data}{A numeric matrix (meta-cells Ã— spatial spots) representing probability distributions.}

\item{dat_visium}{A Seurat Visium object containing the spatial structure of spots.}

\item{visium.data.dir}{Path to the Visium data directory (should contain the \verb{spatial/} folder).}

\item{source_cell_type}{Character. Name of the source cell type.}

\item{receiver_cell_type}{Character. Name of the receiver cell type.}

\item{meta_cell_labels}{Optional. A data frame with columns \code{meta_cell_id}, \code{cell_type}, and optionally \code{cell_type_proportion}.}

\item{cluster_labels}{Optional. A data frame with columns \code{cell}, \code{cluster}, and \code{cell_type} (used if \code{meta_cell_labels} is not supplied).}

\item{thres_source_proportion}{Minimum required cell type proportion in a source meta-cell (default: 0.5).}

\item{thres_receiver_proportion}{Minimum required cell type proportion in a receiver meta-cell (default: 0.5).}

\item{out_file_prefix}{Prefix for saving chunked RDS outputs.}

\item{chunk_size}{Number of meta-cell pairs to compute per batch (default: 10,000).}

\item{out_dir}{Output directory for saving distance files (default: current directory).}

\item{nCores}{Number of CPU cores to use. If NULL, chooses \code{min(20, detectCores()-2)}.}

\item{parallelize}{Logical. Whether to parallelize computation (default: TRUE).}
}
\value{
A data frame with Wasserstein distances between each source-receiver meta-cell pair.
}
\description{
Computes Wasserstein distances between spatial probability vectors of source and receiver cell-type-specific meta-cells.
If \code{meta_cell_labels} is not provided, it derives meta-cell labels by assigning dominant cell types from \code{cluster_labels}.
}
